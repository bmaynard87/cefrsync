import{q as s,J as w,C as h}from"./app-CjSgiM_d.js";function y(){const c=s(!1),i=s(!1),n=s(null),r=w().props.recaptcha?.siteKey,l=()=>new Promise((o,e)=>{if(!r){e(new Error("reCAPTCHA site key not configured"));return}document.querySelectorAll('script[src*="google.com/recaptcha"]').forEach(u=>{u.getAttribute("src")?.includes(`render=${r}`)||u.remove()});const a=document.querySelector(`script[src*="render=${r}"]`);if(a){window.grecaptcha?.ready?window.grecaptcha.ready(()=>{c.value=!0,o()}):a.addEventListener("load",()=>{window.grecaptcha?.ready?window.grecaptcha.ready(()=>{c.value=!0,o()}):e(new Error("reCAPTCHA loaded but grecaptcha not available"))});return}const t=document.createElement("script");t.src=`https://www.google.com/recaptcha/api.js?render=${r}`,t.async=!0,t.defer=!0,t.onload=()=>{window.grecaptcha?.ready?window.grecaptcha.ready(()=>{c.value=!0,o()}):e(new Error("reCAPTCHA script loaded but grecaptcha not available"))},t.onerror=()=>{n.value="Failed to load reCAPTCHA",e(new Error("Failed to load reCAPTCHA script"))},document.head.appendChild(t)}),p=async(o="submit")=>{if(!r)return console.log("reCAPTCHA site key not configured - skipping verification"),"";try{return i.value=!0,n.value=null,c.value||await l(),await new Promise((e,d)=>{window.grecaptcha.ready(async()=>{try{const a=await window.grecaptcha.execute(r,{action:o});e(a)}catch(a){d(a)}})})}catch(e){throw n.value=e instanceof Error?e.message:"reCAPTCHA execution failed",e}finally{i.value=!1}};return h(()=>{r&&l().catch(console.error)}),{isLoaded:c,isExecuting:i,error:n,executeRecaptcha:p}}export{y as u};
