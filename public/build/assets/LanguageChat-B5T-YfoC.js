import{d as D,C as w,c as l,e,a as g,b as _,l as Z,w as V,n as $,g as j,F as E,r as U,o as r,f as oe,m as ie,V as le,t as x,S as ce,k as T,N as q,G as de,j as I,Z as ue,_ as N,i as P,Q as ge,O as he,D as pe,$ as ye,h as ve,E as G,R as me}from"./app-DFAIjR6O.js";import{_ as xe}from"./AppShell.vue_vue_type_script_setup_true_lang-BJoLyPAx.js";import{_ as fe}from"./AppLogo.vue_vue_type_script_setup_true_lang-CB0nt8sT.js";import{c as S,_ as W}from"./Spinner.vue_vue_type_script_setup_true_lang-C8zV1PRL.js";import{C as be}from"./check-C6vXF8pH.js";import{_ as ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./utils-CDN07tui.js";import"./useForwardExpose-CHpEEb4r.js";import"./createContext-CufOWhID.js";const we=S("ArrowRightIcon",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);const ke=S("ChartColumnIcon",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);const te=S("CircleAlertIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);const _e=S("CircleCheckBigIcon",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);const Y=S("LanguagesIcon",[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]]);const Q=S("LightbulbIcon",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);const Ce=S("PencilIcon",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);const $e=S("PlusIcon",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);const Se=S("SendIcon",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);const Me=S("Trash2Icon",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);const Le=S("TriangleAlertIcon",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);const Ie=S("XIcon",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),De={class:"flex h-screen w-64 flex-col border-r border-gray-200 bg-white"},Ae={class:"border-b border-gray-200 px-4 py-4"},Te={class:"border-b border-gray-200 px-4 py-4"},je=["disabled"],Ee={"data-test":"chat-list",class:"flex-1 overflow-y-auto p-2"},Ne={class:"space-y-1"},Pe=["onClick"],ze={class:"min-w-0 flex-1"},Be=["onKeydown"],Ve=["onClick"],Ue={key:1,class:"group/title"},Oe={class:"flex items-center gap-1"},Re=["title"],Ke=["onClick"],He={class:"mt-0.5 truncate text-xs text-gray-500"},Fe=["onClick"],qe=D({__name:"ChatSidebar",props:{chats:{},activeChat:{},hasUnusedNewChat:{type:Boolean}},emits:["new-chat","select-chat","delete-chat","update-title"],setup(s,{emit:h}){const t=s,n=h,p=w(null),d=w(""),f=()=>{t.hasUnusedNewChat||n("new-chat")},m=b=>{p.value!==b&&n("select-chat",b)},y=(b,o)=>{b.stopPropagation(),confirm("Are you sure you want to delete this conversation?")&&n("delete-chat",o)},M=(b,o)=>{b.stopPropagation(),p.value=o.id,d.value=o.title},L=(b,o)=>{b.stopPropagation(),d.value.trim()&&n("update-title",o,d.value.trim()),p.value=null,d.value=""},k=b=>{b.stopPropagation(),p.value=null,d.value=""},C=(b,o)=>{b.key==="Enter"?(b.preventDefault(),L(b,o)):b.key==="Escape"&&k(b)};return(b,o)=>(r(),l("div",De,[e("div",Ae,[g(_(Z),{href:b.route("language-chat.index")},{default:V(()=>[g(fe,{size:"sm"})]),_:1},8,["href"])]),e("div",Te,[e("button",{"data-test":"new-chat-button",onClick:f,disabled:s.hasUnusedNewChat,class:$(["flex w-full items-center justify-center gap-2 rounded-lg px-4 py-2.5 text-sm font-medium transition-colors",s.hasUnusedNewChat?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"])},[g(_($e),{class:"h-4 w-4"}),o[2]||(o[2]=j(" New Chat ",-1))],10,je)]),e("div",Ee,[e("div",Ne,[(r(!0),l(E,null,U(s.chats,a=>(r(),l("div",{key:a.id,"data-test":"chat-item",onClick:u=>m(a.id),class:$(["group flex w-full items-start gap-3 rounded-lg px-3 py-2.5 text-left transition-colors cursor-pointer",s.activeChat===a.id?"bg-gray-100 hover:bg-gray-200":"hover:bg-gray-100"])},[(r(),l("svg",{class:$(["mt-0.5 h-4 w-4 flex-shrink-0",s.activeChat===a.id?"text-gray-600":"text-gray-400"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...o[3]||(o[3]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"},null,-1)])],2)),e("div",ze,[p.value===a.id?(r(),l("div",{key:0,class:"flex items-center gap-1",onClick:o[1]||(o[1]=oe(()=>{},["stop"]))},[ie(e("input",{"onUpdate:modelValue":o[0]||(o[0]=u=>d.value=u),onKeydown:u=>C(u,a.id),type:"text",class:"flex-1 rounded border border-blue-500 px-2 py-1 text-sm focus:outline-none focus:ring-1 focus:ring-blue-500",autofocus:""},null,40,Be),[[le,d.value]]),e("button",{onClick:u=>L(u,a.id),class:"p-1 rounded hover:bg-green-100",title:"Save"},[g(_(be),{class:"h-4 w-4 text-green-600"})],8,Ve),e("button",{onClick:k,class:"p-1 rounded hover:bg-red-100",title:"Cancel"},[g(_(Ie),{class:"h-4 w-4 text-red-600"})])])):(r(),l("div",Ue,[e("div",Oe,[e("p",{class:$(["truncate text-sm font-medium",s.activeChat===a.id?"text-gray-900":"text-gray-700"]),title:a.title},x(a.title),11,Re),e("button",{onClick:u=>M(u,a),class:"flex-shrink-0 opacity-0 group-hover/title:opacity-100 p-0.5 rounded hover:bg-gray-200",title:"Edit title"},[g(_(Ce),{class:"h-3 w-3 text-gray-500"})],8,Ke)]),e("p",He,x(a.timestamp),1)]))]),e("button",{onClick:u=>y(u,a.id),class:"opacity-0 group-hover:opacity-100 transition-opacity p-1 rounded hover:bg-red-50",title:"Delete conversation"},[g(_(Me),{class:"h-4 w-4 text-gray-400 hover:text-red-600"})],8,Fe)],10,Pe))),128))])])]))}}),Je={class:"relative"},Xe={key:0,class:"absolute top-0 right-0 inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-white transform translate-x-1/2 -translate-y-1/2 bg-red-600 rounded-full"},Ge={key:0,class:"absolute right-0 mt-2 w-96 bg-white rounded-lg shadow-xl border border-gray-200 z-50 max-h-[600px] flex flex-col"},Ye={class:"px-4 py-3 border-b border-gray-200 flex items-center justify-between"},Qe={class:"overflow-y-auto flex-1"},Ze={key:0,class:"p-8 text-center text-gray-500"},We={key:1,class:"p-8 text-center text-gray-500"},et={key:2,class:"divide-y divide-gray-200"},tt={class:"flex items-start gap-3"},at={class:"text-2xl flex-shrink-0"},st={class:"flex-1 min-w-0"},nt={class:"flex items-start justify-between gap-2"},rt={class:"font-semibold text-gray-900 text-sm"},ot={class:"flex items-center gap-1 flex-shrink-0"},it=["onClick"],lt=["onClick"],ct={class:"text-sm text-gray-600 mt-1"},dt={class:"text-xs text-gray-400 mt-2"},ut=D({__name:"InsightPanel",setup(s){const h=ce(),t=w([]),n=w(0),p=w(!1),d=w(!1);let f=null;const m=T(()=>!!h.props.auth?.user),y=async(o=!1)=>{if(m.value){o||(p.value=!0);try{const{data:a}=await N.get("/insights");JSON.stringify(t.value)!==JSON.stringify(a.insights)&&(t.value=a.insights),n.value!==a.unread_count&&(n.value=a.unread_count)}catch(a){N.isAxiosError(a)&&a.response?.status===401?f!==null&&(clearInterval(f),f=null):console.error("Error fetching insights:",a)}finally{o||(p.value=!1)}}},M=async o=>{try{await N.patch(`/insights/${o}/read`);const a=t.value.find(u=>u.id===o);a&&(a.is_read=!0,n.value=Math.max(0,n.value-1))}catch(a){console.error("Error marking insight as read:",a)}},L=async()=>{try{await N.post("/insights/mark-all-read"),t.value.forEach(o=>{o.is_read=!0}),n.value=0}catch(o){console.error("Error marking all as read:",o)}},k=async o=>{try{await N.delete(`/insights/${o}`);const a=t.value.findIndex(u=>u.id===o);if(a!==-1){const u=!t.value[a].is_read;t.value.splice(a,1),u&&(n.value=Math.max(0,n.value-1))}}catch(a){console.error("Error deleting insight:",a)}},C=o=>{switch(o){case"grammar_pattern":return"ðŸ“";case"vocabulary_strength":return"ðŸ“š";case"proficiency_suggestion":return"ðŸŽ¯";default:return"ðŸ’¡"}},b=()=>{d.value=!d.value,d.value&&y()};return q(()=>{m.value&&(y(),f=setInterval(()=>y(!0),3e4))}),de(()=>{f!==null&&(clearInterval(f),f=null)}),(o,a)=>(r(),l("div",Je,[e("button",{onClick:b,class:$(["relative p-2 text-gray-600 hover:text-gray-900 transition-colors",{"text-blue-600":d.value}])},[a[1]||(a[1]=e("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})],-1)),n.value>0?(r(),l("span",Xe,x(n.value),1)):I("",!0)],2),g(ue,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-95"},{default:V(()=>[d.value?(r(),l("div",Ge,[e("div",Ye,[a[2]||(a[2]=e("h3",{class:"text-lg font-semibold text-gray-900"},"LangGPT Insights",-1)),t.value.length>0&&n.value>0?(r(),l("button",{key:0,onClick:L,class:"text-sm text-blue-600 hover:text-blue-800"}," Mark all read ")):I("",!0)]),e("div",Qe,[p.value?(r(),l("div",Ze,[g(W,{class:"h-8 w-8 mx-auto mb-2"}),a[3]||(a[3]=j(" Loading insights... ",-1))])):t.value.length===0?(r(),l("div",We,[...a[4]||(a[4]=[e("div",{class:"text-4xl mb-2"},"ðŸ’¡",-1),e("p",{class:"font-medium"},"No insights yet",-1),e("p",{class:"text-sm mt-1"},"Keep chatting to receive personalized feedback!",-1)])])):(r(),l("div",et,[(r(!0),l(E,null,U(t.value,u=>(r(),l("div",{key:u.id,class:$(["p-4 hover:bg-gray-50 transition-colors",{"bg-blue-50/30":!u.is_read}])},[e("div",tt,[e("div",at,x(C(u.insight_type)),1),e("div",st,[e("div",nt,[e("h4",rt,x(u.title),1),e("div",ot,[u.is_read?I("",!0):(r(),l("button",{key:0,onClick:O=>M(u.id),class:"text-blue-600 hover:text-blue-800 p-1",title:"Mark as read"},[...a[5]||(a[5]=[e("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)])],8,it)),e("button",{onClick:O=>k(u.id),class:"text-gray-400 hover:text-red-600 p-1",title:"Dismiss"},[...a[6]||(a[6]=[e("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,lt)])]),e("p",ct,x(u.message),1),e("p",dt,x(new Date(u.created_at).toLocaleDateString()),1)])])],2))),128))]))])])):I("",!0)]),_:1}),d.value?(r(),l("div",{key:0,onClick:a[0]||(a[0]=u=>d.value=!1),class:"fixed inset-0 z-40"})):I("",!0)]))}}),gt={class:"border-b border-gray-200 bg-white px-6 py-4"},ht={class:"flex items-center justify-between"},pt={class:"flex items-center gap-3"},yt={class:"mt-4 flex flex-wrap items-center gap-3"},vt={"data-test":"native-language",class:"flex items-center gap-2 rounded-lg bg-blue-50 px-3 py-1.5"},mt={class:"flex items-center gap-1.5 text-sm"},xt={class:"text-gray-900"},ft={"data-test":"target-language",class:"flex items-center gap-2 rounded-lg bg-green-50 px-3 py-1.5"},bt={class:"flex items-center gap-1.5 text-sm"},wt={class:"text-gray-900"},kt={"data-test":"proficiency-level",class:"flex items-center gap-2 rounded-lg bg-purple-50 px-3 py-1.5"},_t={class:"flex items-center gap-1.5 text-sm"},Ct={class:"text-gray-900"},$t=D({__name:"ChatHeader",props:{nativeLanguage:{},targetLanguage:{},proficiencyLevel:{},proficiencyLabel:{},autoUpdateProficiency:{type:Boolean}},emits:["settings"],setup(s,{emit:h}){const t=s,n=h,p=()=>{n("settings")},d=T(()=>t.proficiencyLevel?t.autoUpdateProficiency?`Dynamic (${t.proficiencyLabel?`${t.proficiencyLevel} - ${t.proficiencyLabel}`:t.proficiencyLevel})`:t.proficiencyLevel+(t.proficiencyLabel?` (${t.proficiencyLabel})`:""):"Not Set");return(f,m)=>(r(),l("div",gt,[e("div",ht,[m[1]||(m[1]=e("div",null,[e("h1",{class:"text-xl font-semibold text-gray-900"},"Language Exchange Chat"),e("p",{class:"text-sm text-gray-500"}," Practice your language skills with AI assistance ")],-1)),e("div",pt,[g(ut),e("button",{"data-test":"settings-button",onClick:p,class:"rounded-lg border border-gray-300 px-4 py-2 text-sm font-medium text-gray-700 transition-colors hover:bg-gray-50"}," Settings "),g(_(Z),{href:f.route("logout"),method:"post",as:"button",class:"rounded-lg border border-gray-300 px-4 py-2 text-sm font-medium text-gray-700 transition-colors hover:bg-gray-50"},{default:V(()=>[...m[0]||(m[0]=[j(" Log out ",-1)])]),_:1},8,["href"])])]),e("div",yt,[e("div",vt,[g(_(Y),{class:"h-4 w-4 text-blue-600"}),e("div",mt,[m[2]||(m[2]=e("span",{class:"font-medium text-gray-700"},"Native:",-1)),e("span",xt,x(s.nativeLanguage),1)])]),g(_(we),{class:"h-4 w-4 text-gray-400"}),e("div",ft,[g(_(Y),{class:"h-4 w-4 text-green-600"}),e("div",bt,[m[3]||(m[3]=e("span",{class:"font-medium text-gray-700"},"Target:",-1)),e("span",wt,x(s.targetLanguage),1)])]),m[5]||(m[5]=e("div",{class:"h-4 w-px bg-gray-300"},null,-1)),e("div",kt,[g(_(ke),{class:"h-4 w-4 text-purple-600"}),e("div",_t,[m[4]||(m[4]=e("span",{class:"font-medium text-gray-700"},"Level:",-1)),e("span",Ct,x(d.value),1)])])])]))}}),St={class:"flex-shrink-0"},Mt={class:"text-sm font-semibold"},Lt={class:"whitespace-pre-wrap break-words text-sm leading-relaxed"},It={key:0,"data-test":"analyzing-indicator",class:"flex items-center gap-1"},Dt=D({__name:"ChatMessage",props:{content:{},role:{},timestamp:{},isAnalyzing:{type:Boolean}},setup(s){return(h,t)=>(r(),l("div",{"data-test":"message-container",class:$(["flex gap-4",s.role==="user"?"flex-row-reverse":"flex-row"])},[e("div",St,[e("div",{"data-test":"message-avatar",class:$(["flex h-10 w-10 items-center justify-center rounded-full text-white",s.role==="user"?"bg-blue-600":"bg-gradient-to-br from-purple-600 to-blue-500"])},[e("span",Mt,x(s.role==="user"?"You":"AI"),1)],2)]),e("div",{"data-test":"message-content",class:$(["max-w-[70%] rounded-2xl px-4 py-3",s.role==="user"?"bg-blue-600 text-white":"bg-white text-gray-900 shadow-sm ring-1 ring-gray-200"])},[e("p",Lt,x(s.content),1),e("div",{class:$(["mt-2 flex items-center gap-2 text-xs",s.role==="user"?"text-blue-100":"text-gray-500"])},[e("span",null,x(s.timestamp),1),s.isAnalyzing?(r(),l("span",It,[g(W,{class:"h-3 w-3"}),t[0]||(t[0]=j(" Analyzing... ",-1))])):I("",!0)],2)],2)],2))}}),At={class:"flex items-center justify-between mb-3"},Tt={class:"flex items-center gap-2"},jt={class:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-3"},Et={class:"space-y-1"},Nt={class:"p-2 rounded bg-gray-100 dark:bg-gray-900 border-2 border-gray-300 dark:border-gray-600"},Pt={class:"text-sm line-through text-gray-800 dark:text-gray-100"},zt={class:"space-y-1"},Bt={class:"text-xs font-semibold text-green-700 dark:text-green-300 uppercase tracking-wide flex items-center gap-1"},Vt={class:"p-2 rounded bg-green-50 dark:bg-green-950/30 border-2 border-green-300 dark:border-green-700"},Ut={class:"text-sm font-medium text-green-800 dark:text-green-200"},Ot={class:"mb-3 p-3 rounded bg-white/50 dark:bg-gray-800/50"},Rt={class:"text-sm text-gray-900 dark:text-gray-50"},Kt={class:"mb-3 p-3 rounded bg-white/50 dark:bg-gray-800/50"},Ht={class:"text-sm text-gray-900 dark:text-gray-50"},Ft={key:0,class:"mb-2 p-3 rounded bg-white/50 dark:bg-gray-800/50"},qt={class:"text-xs font-semibold text-gray-800 dark:text-gray-100 uppercase tracking-wide mb-2 flex items-center gap-1"},Jt={class:"space-y-1"},Xt={class:"text-xs text-gray-500 dark:text-gray-500 text-right mt-2"},Gt=D({__name:"CorrectionMessage",props:{content:{},correctionData:{},timestamp:{}},setup(s){const h=s,t={offensive:"Offensive Language",meaningless:"Unclear Meaning",unnatural:"Unnatural Phrasing",archaic:"Archaic Expression",dangerous:"Potentially Harmful"},n={offensive:"text-red-700 dark:text-red-300",meaningless:"text-orange-700 dark:text-orange-300",unnatural:"text-yellow-700 dark:text-yellow-300",archaic:"text-blue-700 dark:text-blue-300",dangerous:"text-red-800 dark:text-red-200"},p={critical:"bg-red-200 text-red-900 dark:bg-red-900/40 dark:text-red-200",high:"bg-orange-200 text-orange-900 dark:bg-orange-900/40 dark:text-orange-200",medium:"bg-yellow-200 text-yellow-900 dark:bg-yellow-900/40 dark:text-yellow-200"},d={critical:"border-red-300 dark:border-red-700 bg-red-50 dark:bg-red-950/30",high:"border-orange-300 dark:border-orange-700 bg-orange-50 dark:bg-orange-950/30",medium:"border-yellow-300 dark:border-yellow-700 bg-yellow-50 dark:bg-yellow-950/30"},f=T(()=>{switch(h.correctionData.severity){case"critical":return te;case"high":return Le;default:return Q}});return(m,y)=>(r(),l("div",{class:$(["px-4 py-3 rounded-lg border-2 my-3",d[s.correctionData.severity]])},[e("div",At,[e("div",Tt,[(r(),P(ge(f.value),{class:$(["w-5 h-5",n[s.correctionData.error_type]])},null,8,["class"])),e("span",{class:$(["font-semibold text-sm",n[s.correctionData.error_type]])},x(t[s.correctionData.error_type]),3)]),e("span",{class:$(["text-xs font-medium px-2 py-1 rounded-full uppercase tracking-wide",p[s.correctionData.severity]])},x(s.correctionData.severity),3)]),e("div",jt,[e("div",Et,[y[0]||(y[0]=e("div",{class:"text-xs font-semibold text-gray-800 dark:text-gray-200 uppercase tracking-wide"}," Original ",-1)),e("div",Nt,[e("span",Pt,x(s.correctionData.original_text),1)])]),e("div",zt,[e("div",Bt,[g(_(_e),{class:"w-3 h-3"}),y[1]||(y[1]=j(" Suggested ",-1))]),e("div",Vt,[e("span",Ut,x(s.correctionData.corrected_text),1)])])]),e("div",Ot,[y[2]||(y[2]=e("div",{class:"text-xs font-semibold text-gray-800 dark:text-gray-100 uppercase tracking-wide mb-1"}," Explanation ",-1)),e("p",Rt,x(s.correctionData.explanation),1)]),e("div",Kt,[y[3]||(y[3]=e("div",{class:"text-xs font-semibold text-gray-800 dark:text-gray-100 uppercase tracking-wide mb-1"}," Context ",-1)),e("p",Ht,x(s.correctionData.context),1)]),s.correctionData.recommendations&&s.correctionData.recommendations.length>0?(r(),l("div",Ft,[e("div",qt,[g(_(Q),{class:"w-3 h-3"}),y[4]||(y[4]=j(" Recommendations ",-1))]),e("ul",Jt,[(r(!0),l(E,null,U(s.correctionData.recommendations,(M,L)=>(r(),l("li",{key:L,class:"text-sm text-gray-900 dark:text-gray-50 flex items-start gap-2"},[y[5]||(y[5]=e("span",{class:"text-gray-400 dark:text-gray-500"},"â€¢",-1)),e("span",null,x(M),1)]))),128))])])):I("",!0),e("div",Xt,x(s.timestamp),1)],2))}}),Yt=D({inheritAttrs:!1,__name:"SendIcon",setup(s){return(h,t)=>(r(),P(_(Se),he({class:"h-5 w-5"},h.$attrs),null,16))}}),Qt={},Zt={"data-test":"ai-disclaimer",class:"mt-2 flex items-center justify-between text-xs text-gray-500"};function Wt(s,h){return r(),l("div",Zt,[...h[0]||(h[0]=[e("span",null,"Press Enter to send, Shift+Enter for new line",-1),e("span",{class:"text-right"}," AI-generated responses may contain inaccuracies. Always verify important information. ",-1)])])}const ea=ee(Qt,[["render",Wt]]),ta={class:"border-t border-gray-200 bg-white px-4 py-4"},aa={class:"mx-auto max-w-3xl"},sa={class:"relative flex items-end gap-2"},na=["value","disabled"],ra=["disabled"],oa=D({__name:"ChatInput",props:{modelValue:{},disabled:{type:Boolean}},emits:["update:modelValue","send"],setup(s,{expose:h,emit:t}){const n=s,p=t,d=w(null),f=k=>{const C=k.target;p("update:modelValue",C.value)},m=k=>{k.key==="Enter"&&!k.shiftKey&&(k.preventDefault(),n.modelValue.trim()&&!n.disabled&&p("send"))},y=()=>{n.modelValue.trim()&&!n.disabled&&p("send")},M=()=>!n.modelValue.trim()||n.disabled;return pe(()=>n.disabled,(k,C)=>{C&&!k&&setTimeout(()=>{d.value?.focus()},100)}),q(()=>{d.value?.focus()}),h({focus:()=>{d.value?.focus()}}),(k,C)=>(r(),l("div",ta,[e("div",aa,[e("div",sa,[e("textarea",{ref_key:"textareaRef",ref:d,value:s.modelValue,onInput:f,onKeydown:m,disabled:s.disabled,placeholder:"Type your message here... (Shift+Enter for new line)",rows:"1",class:"max-h-32 min-h-[44px] flex-1 resize-none rounded-xl border border-gray-300 px-4 py-3 pr-12 text-sm focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 disabled:cursor-not-allowed disabled:opacity-50"},null,40,na),e("button",{"data-test":"send-button",onClick:y,disabled:M(),class:"absolute bottom-2 right-2 flex h-8 w-8 items-center justify-center rounded-lg bg-blue-600 text-white transition-all hover:bg-blue-700 disabled:cursor-not-allowed disabled:opacity-50"},[g(Yt)],8,ra)]),g(ea)])]))}}),ia={},la={class:"flex gap-4"};function ca(s,h){return r(),l("div",la,[...h[0]||(h[0]=[ye('<div class="flex-shrink-0"><div data-test="typing-avatar" class="flex h-10 w-10 items-center justify-center rounded-full bg-gradient-to-br from-purple-600 to-blue-500 text-white"><span class="text-sm font-semibold">AI</span></div></div><div data-test="typing-container" class="rounded-2xl bg-white px-4 py-3 shadow-sm ring-1 ring-gray-200"><div class="flex gap-1"><div data-test="typing-dot" class="h-2 w-2 animate-bounce rounded-full bg-gray-400 [animation-delay:-0.3s]"></div><div data-test="typing-dot" class="h-2 w-2 animate-bounce rounded-full bg-gray-400 [animation-delay:-0.15s]"></div><div data-test="typing-dot" class="h-2 w-2 animate-bounce rounded-full bg-gray-400"></div></div></div>',2)])])}const da=ee(ia,[["render",ca]]),ua={key:0,"data-test":"service-down-banner",class:"border-l-4 border-red-200 bg-red-50 p-4"},ga={class:"flex items-start gap-3"},ha=D({__name:"ServiceDownBanner",props:{isServiceDown:{type:Boolean}},setup(s){return(h,t)=>s.isServiceDown?(r(),l("div",ua,[e("div",ga,[g(_(te),{"data-test":"alert-icon",class:"h-5 w-5 flex-shrink-0 text-red-600"}),t[0]||(t[0]=e("div",{class:"flex-1"},[e("h3",{class:"text-sm font-semibold text-red-800"}," Language processing service is currently unavailable "),e("p",{class:"mt-1 text-sm text-red-700"}," Chat functionality is temporarily disabled. Please try again later. ")],-1))])])):I("",!0)}}),pa={"data-test":"main-container",class:"flex h-screen w-full overflow-hidden bg-gray-50"},ya={"data-test":"chat-area",class:"flex min-w-0 flex-1 flex-col"},va={key:0,class:"flex h-full items-center justify-center"},ma={class:"text-center"},xa={class:"mb-8 text-gray-600"},fa={class:"space-y-4"},ba={class:"mt-6 grid grid-cols-1 gap-4 sm:grid-cols-3"},wa={class:"rounded-lg border border-gray-200 bg-white p-4"},ka={class:"text-sm text-gray-600 text-center"},_a={key:1,class:"mx-auto max-w-3xl space-y-6"},ja=D({__name:"LanguageChat",props:{chatHistory:{},userSettings:{},isServiceAvailable:{type:Boolean}},setup(s){const h=s,t=w(h.chatHistory),n=w(t.value[0]?.id||null),p=w([]),d=w(""),f=w(!1),m=w(!h.isServiceAvailable),y=w(null),M=w(null),L=w(h.userSettings.native_language),k=w(h.userSettings.target_language),C=w(h.userSettings.proficiency_level),b=w(h.userSettings.auto_update_proficiency),o=T(()=>({A1:"Beginner",A2:"Elementary",B1:"Intermediate",B2:"Upper Intermediate",C1:"Advanced",C2:"Proficient"})[C.value]||C.value),a=T(()=>{if(n.value){const v=t.value.find(i=>i.id===n.value);if(v)return v.title}return"Language Chat"}),u=T(()=>t.value.some(v=>v.title==="New Conversation")),O=T(()=>f.value||m.value),z=async()=>{await G(),y.value&&(y.value.scrollTop=y.value.scrollHeight)},J=async v=>{try{const c=await(await fetch(route("language-chat.messages",{chatSession:v}))).json();p.value=c.messages,await z()}catch(i){console.error("Error loading messages:",i)}},ae=async()=>{if(!d.value.trim())return;if(!n.value&&(await R(),await new Promise(c=>setTimeout(c,100)),!n.value)){console.error("Failed to create chat session");return}const v=d.value,i={id:Date.now(),content:v,sender_type:"user",created_at:new Date().toISOString()};p.value.push(i),d.value="",f.value=!0,await z(),await G(),M.value?.focus();try{const c=route("language-chat.message",{chatSession:n.value}),A=await(await fetch(c,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify({message:v})})).json(),X=p.value.findIndex(F=>F.id===i.id);X!==-1&&(p.value[X]={...A.user_message,sender_type:"user"}),A.correction_message&&(p.value.push({...A.correction_message,sender_type:"system",message_type:"correction"}),await z()),p.value.push({...A.ai_response,sender_type:"assistant"}),f.value=!1,await z();const H=t.value.findIndex(F=>F.id===n.value);H!==-1&&(t.value[H].last_message_at=new Date().toISOString(),A.new_title&&(t.value[H].title=A.new_title))}catch(c){console.error("Error sending message:",c),f.value=!1}},R=async()=>{const v=t.value.find(i=>i.title==="New Conversation");if(v){B(v.id);return}if(!u.value)try{const c=await(await fetch(route("language-chat.create"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify({native_language:L.value,target_language:k.value,proficiency_level:C.value})})).json();t.value.unshift({id:c.id,title:"New Conversation",last_message_at:c.created_at,native_language:c.native_language,target_language:c.target_language}),B(c.id)}catch(i){console.error("Error creating new chat:",i)}},B=async v=>{n.value=v,await J(v)},se=async v=>{try{(await fetch(route("language-chat.destroy",{chatSession:v}),{method:"DELETE",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""}})).ok&&(t.value=t.value.filter(c=>c.id!==v),n.value===v&&(t.value.length>0?B(t.value[0].id):(n.value=null,p.value=[])))}catch(i){console.error("Error deleting chat:",i)}},ne=async(v,i)=>{try{if((await fetch(route("language-chat.update-title",{chatSession:v}),{method:"PATCH",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify({title:i})})).ok){const K=t.value.findIndex(A=>A.id===v);K!==-1&&(t.value[K].title=i)}}catch(c){console.error("Error updating chat title:",c)}},re=()=>{me.visit("/profile")};return q(()=>{n.value&&J(n.value)}),(v,i)=>(r(),l(E,null,[g(_(ve),{title:a.value},null,8,["title"]),g(xe,null,{default:V(()=>[e("div",pa,[g(qe,{chats:t.value,"active-chat":n.value,"has-unused-new-chat":u.value,onNewChat:R,onSelectChat:B,onDeleteChat:se,onUpdateTitle:ne},null,8,["chats","active-chat","has-unused-new-chat"]),e("div",ya,[g($t,{"native-language":L.value,"target-language":k.value,"proficiency-level":C.value,"proficiency-label":o.value,"auto-update-proficiency":b.value,onSettings:re},null,8,["native-language","target-language","proficiency-level","proficiency-label","auto-update-proficiency"]),e("div",{ref_key:"chatContainer",ref:y,"data-test":"chat-container",class:"flex-1 overflow-y-auto px-4 py-6"},[!n.value&&t.value.length===0?(r(),l("div",va,[e("div",ma,[i[6]||(i[6]=e("div",{class:"mx-auto mb-6 flex h-20 w-20 items-center justify-center rounded-full bg-blue-100"},[e("svg",{class:"h-10 w-10 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})])],-1)),i[7]||(i[7]=e("h2",{class:"mb-2 text-2xl font-semibold text-gray-900"},"Start Your Language Journey",-1)),e("p",xa,"Practice "+x(k.value)+" with AI-powered conversations tailored to your level",1),e("div",fa,[e("button",{onClick:R,class:"inline-flex items-center gap-2 rounded-lg bg-blue-600 px-6 py-3 text-base font-medium text-white transition-colors hover:bg-blue-700"},[...i[1]||(i[1]=[e("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),j(" Start New Conversation ",-1)])]),e("div",ba,[e("div",wa,[i[2]||(i[2]=e("div",{class:"mb-2 flex h-10 w-10 items-center justify-center rounded-full bg-green-100 mx-auto"},[e("svg",{class:"h-5 w-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),i[3]||(i[3]=e("h3",{class:"mb-1 font-medium text-gray-900 text-center"},"Adaptive Learning",-1)),e("p",ka,"AI adjusts to your "+x(C.value)+" level",1)]),i[4]||(i[4]=e("div",{class:"rounded-lg border border-gray-200 bg-white p-4"},[e("div",{class:"mb-2 flex h-10 w-10 items-center justify-center rounded-full bg-purple-100 mx-auto"},[e("svg",{class:"h-5 w-5 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"})])]),e("h3",{class:"mb-1 font-medium text-gray-900 text-center"},"Natural Conversation"),e("p",{class:"text-sm text-gray-600 text-center"},"Practice real-world dialogue")],-1)),i[5]||(i[5]=e("div",{class:"rounded-lg border border-gray-200 bg-white p-4"},[e("div",{class:"mb-2 flex h-10 w-10 items-center justify-center rounded-full bg-orange-100 mx-auto"},[e("svg",{class:"h-5 w-5 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})])]),e("h3",{class:"mb-1 font-medium text-gray-900 text-center"},"Instant Feedback"),e("p",{class:"text-sm text-gray-600 text-center"},"Get corrections and suggestions")],-1))])])])])):(r(),l("div",_a,[(r(!0),l(E,null,U(p.value,c=>(r(),l(E,{key:c.id},[c.message_type==="correction"&&c.correction_data?(r(),P(Gt,{key:0,content:c.content,"correction-data":c.correction_data,timestamp:new Date(c.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})},null,8,["content","correction-data","timestamp"])):(r(),P(Dt,{key:1,content:c.content,role:c.sender_type,timestamp:new Date(c.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),"is-analyzing":c.isAnalyzing},null,8,["content","role","timestamp","is-analyzing"]))],64))),128)),f.value?(r(),P(da,{key:0})):I("",!0)]))],512),g(ha,{"is-service-down":m.value},null,8,["is-service-down"]),g(oa,{modelValue:d.value,"onUpdate:modelValue":i[0]||(i[0]=c=>d.value=c),disabled:O.value,onSend:ae,ref_key:"chatInputRef",ref:M},null,8,["modelValue","disabled"])])])]),_:1})],64))}});export{ja as default};
